{% extends "base.html" %}

{% block title %}Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª - Ù†Ø¸Ø§Ù… POS{% endblock %}
{% block page_title %}Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª{% endblock %}

{% block extra_css %}
<style>
    .reports-container {
        padding: 2rem 0;
    }

    .report-card {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
        transition: all 0.3s ease;
    }

    .report-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }

    .report-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid #f1f3f4;
    }

    .report-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-color);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .ai-badge {
        background: linear-gradient(45deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 0.25rem 0.75rem;
        border-radius: 15px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .chart-container {
        height: 400px;
        margin: 1rem 0;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .stat-item {
        background: linear-gradient(135deg, var(--secondary-color) 0%, var(--primary-color) 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 10px;
        text-align: center;
    }

    .stat-value {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .stat-label {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .ai-insights {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px;
        padding: 2rem;
        margin-bottom: 2rem;
    }

    .insight-item {
        background: rgba(255,255,255,0.1);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
        border-left: 4px solid #fff;
    }

    .insight-title {
        font-weight: 600;
        margin-bottom: 0.5rem;
    }

    .insight-text {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    .filter-section {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }

    .filter-row {
        display: flex;
        gap: 1rem;
        align-items: end;
        flex-wrap: wrap;
    }

    .filter-group {
        flex: 1;
        min-width: 200px;
    }

    .btn-generate {
        background: linear-gradient(45deg, var(--success-color), #58d68d);
        border: none;
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 10px;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .btn-generate:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(39, 174, 96, 0.3);
    }

    .loading-spinner {
        display: none;
        text-align: center;
        padding: 2rem;
    }

    .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid var(--primary-color);
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        margin: 0 auto 1rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .recommendations-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
    }

    .recommendation-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        border-left: 4px solid var(--secondary-color);
    }

    .recommendation-type {
        font-weight: 600;
        color: var(--secondary-color);
        margin-bottom: 0.5rem;
    }

    .recommendation-text {
        color: #666;
        line-height: 1.6;
    }

    .financial-statement {
        background: white;
        border-radius: 10px;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .statement-header {
        text-align: center;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--primary-color);
    }

    .statement-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
    }

    .statement-period {
        color: #666;
        font-size: 1rem;
    }

    .financial-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1rem;
    }

    .financial-table th,
    .financial-table td {
        padding: 0.75rem;
        text-align: right;
        border-bottom: 1px solid #eee;
    }

    .financial-table th {
        background: #f8f9fa;
        font-weight: 600;
        color: var(--primary-color);
    }

    .financial-table .category-header {
        background: var(--secondary-color);
        color: white;
        font-weight: 600;
    }

    .financial-table .total-row {
        background: #f0f8ff;
        font-weight: 600;
        border-top: 2px solid var(--primary-color);
    }

    .financial-table .final-total {
        background: var(--primary-color);
        color: white;
        font-weight: 700;
        font-size: 1.1rem;
    }

    .amount-positive {
        color: #28a745;
    }

    .amount-negative {
        color: #dc3545;
    }

    .amount {
        text-align: left;
        font-weight: bold;
    }

    .profit {
        color: #28a745;
        background-color: rgba(40, 167, 69, 0.1);
    }

    .section-header {
        background-color: #f8f9fa;
        font-weight: bold;
    }

    .total-row {
        background-color: #e9ecef;
        font-weight: bold;
    }

    .grand-total-row {
        background-color: #dee2e6;
        font-weight: bold;
        border-top: 2px solid #6c757d;
    }

    .profit-row {
        background-color: rgba(40, 167, 69, 0.1);
        font-weight: bold;
        border-top: 2px solid #28a745;
    }

    .summary-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-bottom: 1rem;
    }

    .summary-value {
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 0.5rem;
    }

    .summary-label {
        color: #6c757d;
        font-size: 0.9rem;
    }

    .balance-summary {
        margin-bottom: 2rem;
    }

    .balance-summary .summary-card {
        background: linear-gradient(135deg, var(--bs-primary) 0%, var(--bs-primary-dark, #0056b3) 100%);
        color: white;
        border: none;
        transition: transform 0.3s ease;
    }

    .balance-summary .summary-card:hover {
        transform: translateY(-5px);
    }

    .balance-summary .bg-primary {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%) !important;
    }

    .balance-summary .bg-danger {
        background: linear-gradient(135deg, #dc3545 0%, #a71e2a 100%) !important;
    }

    .balance-summary .bg-success {
        background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%) !important;
    }

    .balance-summary .bg-warning {
        background: linear-gradient(135deg, #ffc107 0%, #d39e00 100%) !important;
        color: #212529 !important;
    }

    .financial-ratios {
        background: #f8f9fa;
        padding: 2rem;
        border-radius: 10px;
        margin-top: 2rem;
    }

    .ratio-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        margin-bottom: 1rem;
        transition: transform 0.3s ease;
    }

    .ratio-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }

    .ratio-value {
        font-size: 2.5rem;
        font-weight: bold;
        color: #495057;
        margin-bottom: 0.5rem;
    }

    .ratio-label {
        font-size: 0.9rem;
        color: #6c757d;
        margin-bottom: 0.5rem;
    }

    .ratio-status {
        font-size: 0.8rem;
        font-weight: bold;
        padding: 0.25rem 0.5rem;
        border-radius: 15px;
        display: inline-block;
    }

    .financial-table th.bg-primary {
        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%) !important;
    }

    .financial-table th.bg-danger {
        background: linear-gradient(135deg, #dc3545 0%, #a71e2a 100%) !important;
    }

    .financial-table td i {
        margin-right: 0.5rem;
        width: 16px;
        text-align: center;
    }

    .financial-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 2rem;
    }

    .summary-card {
        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        color: white;
        padding: 1.5rem;
        border-radius: 10px;
        text-align: center;
    }

    .summary-value {
        font-size: 1.8rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .summary-label {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    @media (max-width: 768px) {
        .filter-row {
            flex-direction: column;
        }
        
        .filter-group {
            min-width: auto;
        }
        
        .stats-grid {
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="reports-container">
    <!-- Filters Section -->
    <div class="filter-section">
        <h5 class="mb-3">
            <i class="fas fa-filter text-primary"></i>
            ÙÙ„Ø§ØªØ± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
        </h5>
        <div class="filter-row">
            <div class="filter-group">
                <label class="form-label">Ù…Ù† ØªØ§Ø±ÙŠØ®</label>
                <input type="date" class="form-control" id="startDate">
            </div>
            <div class="filter-group">
                <label class="form-label">Ø¥Ù„Ù‰ ØªØ§Ø±ÙŠØ®</label>
                <input type="date" class="form-control" id="endDate">
            </div>
            <div class="filter-group">
                <label class="form-label">Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</label>
                <select class="form-control" id="reportType">
                    <option value="sales">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</option>
                    <option value="purchases">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</option>
                    <option value="products">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</option>
                    <!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
                    <optgroup label="ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©">
                        <option value="sales-summary-daily">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©</option>
                        <option value="sales-summary-monthly">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</option>
                        <option value="sales-summary-yearly">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø³Ù†ÙˆÙŠØ©</option>
                        <option value="best-products-sales">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Ù‹</option>
                        <option value="best-products-profit">Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø±Ø¨Ø­ÙŠØ©</option>
                        <option value="best-customers">Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
                        <option value="customers">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
                    </optgroup>

                    <!-- Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ© -->
                    <optgroup label="ğŸ’° Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©">
                        <option value="profit_loss">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</option>
                        <option value="balance_sheet">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</option>
                        <option value="cash_flow">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</option>
                        <option value="income_statement">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</option>
                        <option value="financial_position">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ</option>
                        <option value="profit-analysis">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª</option>
                    </optgroup>

                    <!-- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ† -->
                    <optgroup label="ğŸ“¦ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ†">
                        <option value="inventory-status">ÙƒÙ…ÙŠØ§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</option>
                        <option value="inventory-predictions">ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</option>
                        <option value="slow-moving">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø±Ø§ÙƒØ¯Ø©</option>
                        <option value="out-of-stock">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</option>
                    </optgroup>

                    <!-- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª -->
                    <optgroup label="ğŸ’³ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª">
                        <option value="payment-delays">ØªÙ‚Ø§Ø±ÙŠØ± ØªØ£Ø®Ø± Ø§Ù„Ø³Ø¯Ø§Ø¯</option>
                        <option value="payment-history">Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</option>
                        <option value="receivables">Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>
                        <option value="payables">Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©</option>
                    </optgroup>

                    <!-- Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
                    <optgroup label="ğŸ¤– Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©">
                        <option value="time-analysis">ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª ÙˆØ§Ù„Ø£ÙŠØ§Ù…</option>
                        <option value="business-plan">Ø®Ø·Ø© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø°ÙƒÙŠØ©</option>
                        <option value="automated-report">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</option>
                    </optgroup>
                    <option value="sales-prediction">ØªÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</option>
                    <option value="customer-behavior">ØªØ­Ù„ÙŠÙ„ Ø³Ù„ÙˆÙƒ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</option>
                    <option value="smart-alerts">Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</option>
                </select>
            </div>
            <div class="filter-group">
                <button class="btn btn-generate w-100" onclick="generateReport()">
                    <i class="fas fa-chart-line"></i>
                    Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
                </button>
            </div>
            <div class="filter-group">
                <button class="btn btn-outline-danger" onclick="exportToPDF()">
                    <i class="fas fa-file-pdf"></i>
                    ØªØµØ¯ÙŠØ± PDF
                </button>
            </div>
            <div class="filter-group">
                <button class="btn btn-outline-success" onclick="exportToExcel()">
                    <i class="fas fa-file-excel"></i>
                    ØªØµØ¯ÙŠØ± Excel
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
        <p>Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
    </div>

    <!-- AI Insights Section -->
    <div class="ai-insights" id="aiInsights" style="display: none;">
        <h4 class="mb-3">
            <i class="fas fa-brain"></i>
            ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            <span class="ai-badge">AI Powered</span>
        </h4>
        <div id="insightsContent">
            <!-- AI insights will be loaded here -->
        </div>
    </div>

    <!-- Statistics Overview -->
    <div class="report-card" id="statsOverview" style="display: none;">
        <div class="report-header">
            <div class="report-title">
                <i class="fas fa-chart-bar"></i>
                Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            </div>
        </div>
        <div class="stats-grid" id="statsGrid">
            <!-- Stats will be loaded here -->
        </div>
    </div>

    <!-- Charts Section -->
    <div class="report-card" id="chartsSection" style="display: none;">
        <div class="report-header">
            <div class="report-title">
                <i class="fas fa-chart-line"></i>
                Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
            </div>
        </div>
        <div class="chart-container">
            <canvas id="mainChart"></canvas>
        </div>
    </div>

    <!-- AI Recommendations -->
    <div class="report-card" id="recommendationsSection" style="display: none;">
        <div class="report-header">
            <div class="report-title">
                <i class="fas fa-lightbulb"></i>
                ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                <span class="ai-badge">AI Powered</span>
            </div>
        </div>
        <div class="recommendations-grid" id="recommendationsGrid">
            <!-- Recommendations will be loaded here -->
        </div>
    </div>

    <!-- Financial Statements Section -->
    <div class="report-card" id="financialStatementsSection" style="display: none;">
        <div class="report-header">
            <div class="report-title">
                <i class="fas fa-chart-pie"></i>
                Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©
            </div>
            <div>
                <button class="btn btn-outline-primary btn-sm" onclick="exportFinancialStatement()">
                    <i class="fas fa-download"></i> ØªØµØ¯ÙŠØ±
                </button>
                <button class="btn btn-outline-success btn-sm" onclick="printFinancialStatement()">
                    <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø©
                </button>
            </div>
        </div>
        <div id="financialContent">
            <!-- Financial statements will be loaded here -->
        </div>
    </div>

    <!-- Advanced Analytics Section -->
    <div class="report-card" id="advancedAnalyticsSection" style="display: none;">
        <div class="report-header">
            <div class="report-title">
                <i class="fas fa-brain"></i>
                Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                <span class="ai-badge">AI Powered</span>
            </div>
        </div>
        <div id="analyticsContent">
            <!-- Advanced analytics will be loaded here -->
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    let currentChart = null;

    document.addEventListener('DOMContentLoaded', function() {
        // Set default dates
        const today = new Date();
        const lastMonth = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
        
        document.getElementById('startDate').value = lastMonth.toISOString().split('T')[0];
        document.getElementById('endDate').value = today.toISOString().split('T')[0];
    });

    async function generateReport() {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;
        const reportType = document.getElementById('reportType').value;

        if (!startDate || !endDate) {
            alert('ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© ÙˆØ§Ù„Ù†Ù‡Ø§ÙŠØ©');
            return;
        }

        // Show loading
        document.getElementById('loadingSpinner').style.display = 'block';
        hideAllSections();

        try {
            // Generate report data
            const reportData = await fetchReportData(reportType, startDate, endDate);
            
            // Generate AI insights
            const aiInsights = await generateAIInsights(reportData, reportType);
            
            // Display results
            displayStats(reportData.stats);
            if (reportType.includes('financial') || reportType === 'profit_loss' ||
                reportType === 'balance_sheet' || reportType === 'cash_flow' ||
                reportType === 'income_statement' || reportType === 'financial_position' ||
                reportType === 'receivables' || reportType === 'payables') {
                displayFinancialStatement(reportData, reportType);
                showFinancialSections();
            } else if (reportType === 'payment-history') {
                await generatePaymentHistoryReport();
            } else if (reportType === 'out-of-stock') {
                await generateOutOfStockReport();
            } else {
                displayChart(reportData.chartData, reportType);
                displayAIInsights(aiInsights);
                displayRecommendations(aiInsights.recommendations);
                showAllSections();
            }
            
        } catch (error) {
            console.error('Error generating report:', error);
            alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØªÙ‚Ø±ÙŠØ±');
        } finally {
            document.getElementById('loadingSpinner').style.display = 'none';
        }
    }

    async function fetchReportData(reportType, startDate, endDate) {
        // Simulate API call - replace with actual API
        return new Promise(resolve => {
            setTimeout(() => {
                const mockData = {
                    sales: {
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª', value: '125,450', icon: 'fas fa-dollar-sign' },
                            { label: 'Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±', value: '342', icon: 'fas fa-receipt' },
                            { label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„ÙØ§ØªÙˆØ±Ø©', value: '367', icon: 'fas fa-chart-line' },
                            { label: 'Ø£ÙØ¶Ù„ Ù…Ù†ØªØ¬', value: 'Ù…Ù†ØªØ¬ A', icon: 'fas fa-star' }
                        ],
                        chartData: {
                            labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'],
                            datasets: [{
                                label: 'Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                                data: [12000, 19000, 15000, 25000, 22000, 30000],
                                borderColor: 'rgb(75, 192, 192)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                tension: 0.4
                            }]
                        }
                    },
                    purchases: {
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª', value: '85,200', icon: 'fas fa-shopping-cart' },
                            { label: 'Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±', value: '156', icon: 'fas fa-file-invoice' },
                            { label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„ÙØ§ØªÙˆØ±Ø©', value: '546', icon: 'fas fa-chart-bar' },
                            { label: 'Ø£ÙØ¶Ù„ Ù…ÙˆØ±Ø¯', value: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙˆØ±', icon: 'fas fa-truck' }
                        ],
                        chartData: {
                            labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ'],
                            datasets: [{
                                label: 'Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª',
                                data: [8000, 12000, 10000, 15000, 14000, 18000],
                                borderColor: 'rgb(255, 99, 132)',
                                backgroundColor: 'rgba(255, 99, 132, 0.2)',
                                tension: 0.4
                            }]
                        }
                    },
                    income_statement: {
                        total_sales: 122950,
                        other_income: 2500,
                        cost_of_goods: 75000,
                        operating_expenses: 15000,
                        admin_expenses: 7200,
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª', value: '125,450', icon: 'fas fa-arrow-up' },
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ', value: '97,200', icon: 'fas fa-arrow-down' },
                            { label: 'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­', value: '28,250', icon: 'fas fa-chart-line' },
                            { label: 'Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­', value: '22.5%', icon: 'fas fa-percentage' }
                        ]
                    },
                    financial_position: {
                        cash: 45000,
                        accounts_receivable: 35000,
                        inventory_value: 85000,
                        equipment: 35000,
                        furniture: 20000,
                        accounts_payable: 25000,
                        accrued_expenses: 18000,
                        capital: 150000,
                        retained_earnings: 27000,
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„', value: '220,000', icon: 'fas fa-building' },
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…', value: '43,000', icon: 'fas fa-credit-card' },
                            { label: 'Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©', value: '177,000', icon: 'fas fa-user-tie' },
                            { label: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø©', value: '3.8', icon: 'fas fa-tint' }
                        ]
                    },
                    receivables: {
                        receivables: [
                            { name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ', phone: '01234567890', balance: -1500, last_transaction: '2025-07-15' },
                            { name: 'ÙØ§Ø·Ù…Ø© Ø­Ø³Ù†', phone: '01098765432', balance: -750, last_transaction: '2025-07-20' },
                            { name: 'Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯', phone: '01555666777', balance: -2200, last_transaction: '2025-06-25' },
                            { name: 'Ø¹Ù„ÙŠ Ø­Ø³ÙŠÙ†', phone: '01777888999', balance: -950, last_transaction: '2025-07-28' }
                        ],
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©', value: '5,400', icon: 'fas fa-user-clock' },
                            { label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ†', value: '4', icon: 'fas fa-users' },
                            { label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©', value: '1,350', icon: 'fas fa-calculator' },
                            { label: 'Ø­Ø³Ø§Ø¨Ø§Øª Ù…ØªØ£Ø®Ø±Ø©', value: '1', icon: 'fas fa-exclamation-triangle' }
                        ]
                    },
                    balance_sheet: {
                        cash: 45000,
                        accounts_receivable: 35000,
                        inventory_value: 85000,
                        prepaid_expenses: 8000,
                        equipment: 50000,
                        furniture: 15000,
                        accumulated_depreciation: 12000,
                        accounts_payable: 25000,
                        accrued_expenses: 18000,
                        short_term_loans: 15000,
                        long_term_loans: 30000,
                        capital: 150000,
                        retained_earnings: 27000,
                        current_year_profit: 28250,
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„', value: '221,000', icon: 'fas fa-building' },
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…', value: '88,000', icon: 'fas fa-credit-card' },
                            { label: 'Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©', value: '205,250', icon: 'fas fa-user-tie' },
                            { label: 'Ù†Ø³Ø¨Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø©', value: '2.9', icon: 'fas fa-tint' }
                        ]
                    },
                    payables: {
                        payables: [
                            { name: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙˆØ± Ù„Ù„ØªØ¬Ø§Ø±Ø©', phone: '01111222333', balance: 5000, last_transaction: '2025-07-10' },
                            { name: 'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ù…Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©', phone: '01444555666', balance: 3200, last_transaction: '2025-07-18' },
                            { name: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„', phone: '01888999000', balance: 12500, last_transaction: '2025-07-05' },
                            { name: 'Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ø¯Ù…', phone: '01333444555', balance: 2800, last_transaction: '2025-07-25' }
                        ],
                        stats: [
                            { label: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©', value: '23,500', icon: 'fas fa-truck' },
                            { label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ† Ø§Ù„Ø¯Ø§Ø¦Ù†ÙŠÙ†', value: '4', icon: 'fas fa-industry' },
                            { label: 'Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª', value: '5,875', icon: 'fas fa-calculator' },
                            { label: 'Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©', value: '1', icon: 'fas fa-exclamation-circle' }
                        ]
                    }
                };
                resolve(mockData[reportType] || mockData.sales);
            }, 2000);
        });
    }

    async function generateAIInsights(reportData, reportType) {
        // Simulate AI analysis
        return new Promise(resolve => {
            setTimeout(() => {
                const insights = {
                    sales: {
                        insights: [
                            {
                                title: 'Ù†Ù…Ùˆ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª',
                                text: 'ØªØ´Ù‡Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù†Ù…ÙˆØ§Ù‹ Ù…Ø³ØªÙ…Ø±Ø§Ù‹ Ø¨Ù†Ø³Ø¨Ø© 15% Ø´Ù‡Ø±ÙŠØ§Ù‹ØŒ Ù…Ù…Ø§ ÙŠØ´ÙŠØ± Ø¥Ù„Ù‰ ØµØ­Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„.'
                            },
                            {
                                title: 'Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ù„Ù„Ø¨ÙŠØ¹',
                                text: 'ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙŠØ¸Ù‡Ø± Ø£Ù† Ø£ÙØ¶Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¨ÙŠØ¹ Ù‡ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø³Ø§Ø¹Ø© 2-5 Ù…Ø³Ø§Ø¡Ù‹.'
                            },
                            {
                                title: 'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ø±Ø¨Ø­ÙŠØ©',
                                text: 'Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ø§Ù„ÙØ¦Ø© A ØªØ­Ù‚Ù‚ Ø£Ø¹Ù„Ù‰ Ù‡Ø§Ù…Ø´ Ø±Ø¨Ø­ Ø¨Ù†Ø³Ø¨Ø© 35%.'
                            }
                        ],
                        recommendations: [
                            {
                                type: 'ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù…Ø®Ø²ÙˆÙ†',
                                text: 'ÙŠÙÙ†ØµØ­ Ø¨Ø²ÙŠØ§Ø¯Ø© Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø£ÙƒØ«Ø± Ù…Ø¨ÙŠØ¹Ø§Ù‹ Ù„ØªØ¬Ù†Ø¨ Ù†ÙØ§Ø¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†.'
                            },
                            {
                                type: 'Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ø§Ù„ØªØ³Ø¹ÙŠØ±',
                                text: 'ÙŠÙ…ÙƒÙ† Ø²ÙŠØ§Ø¯Ø© Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø³Ø¨Ø© 5-10% Ø¯ÙˆÙ† ØªØ£Ø«ÙŠØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª.'
                            },
                            {
                                type: 'ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø¹Ø±ÙˆØ¶',
                                text: 'Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„ØªØ±ÙˆÙŠØ¬ÙŠØ© ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ÙŠØ­Ù‚Ù‚ Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬.'
                            }
                        ]
                    }
                };
                resolve(insights[reportType] || insights.sales);
            }, 1500);
        });
    }

    function displayStats(stats) {
        const statsGrid = document.getElementById('statsGrid');
        statsGrid.innerHTML = '';
        
        stats.forEach(stat => {
            const statItem = document.createElement('div');
            statItem.className = 'stat-item';
            statItem.innerHTML = `
                <i class="${stat.icon} fa-2x mb-2"></i>
                <div class="stat-value">${stat.value}</div>
                <div class="stat-label">${stat.label}</div>
            `;
            statsGrid.appendChild(statItem);
        });
    }

    function displayChart(chartData, reportType) {
        const ctx = document.getElementById('mainChart').getContext('2d');
        
        if (currentChart) {
            currentChart.destroy();
        }
        
        currentChart = new Chart(ctx, {
            type: 'line',
            data: chartData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: reportType === 'sales' ? 'ØªØ·ÙˆØ± Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª' : 'ØªØ·ÙˆØ± Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    }

    function displayAIInsights(aiData) {
        const insightsContent = document.getElementById('insightsContent');
        insightsContent.innerHTML = '';
        
        aiData.insights.forEach(insight => {
            const insightItem = document.createElement('div');
            insightItem.className = 'insight-item';
            insightItem.innerHTML = `
                <div class="insight-title">${insight.title}</div>
                <div class="insight-text">${insight.text}</div>
            `;
            insightsContent.appendChild(insightItem);
        });
    }

    function displayRecommendations(recommendations) {
        const recommendationsGrid = document.getElementById('recommendationsGrid');
        recommendationsGrid.innerHTML = '';
        
        recommendations.forEach(rec => {
            const recCard = document.createElement('div');
            recCard.className = 'recommendation-card';
            recCard.innerHTML = `
                <div class="recommendation-type">${rec.type}</div>
                <div class="recommendation-text">${rec.text}</div>
            `;
            recommendationsGrid.appendChild(recCard);
        });
    }

    function hideAllSections() {
        document.getElementById('aiInsights').style.display = 'none';
        document.getElementById('statsOverview').style.display = 'none';
        document.getElementById('chartsSection').style.display = 'none';
        document.getElementById('recommendationsSection').style.display = 'none';
    }

    function showAllSections() {
        document.getElementById('aiInsights').style.display = 'block';
        document.getElementById('statsOverview').style.display = 'block';
        document.getElementById('chartsSection').style.display = 'block';
        document.getElementById('recommendationsSection').style.display = 'block';
        document.getElementById('financialStatementsSection').style.display = 'none';
    }

    function showFinancialSections() {
        document.getElementById('aiInsights').style.display = 'none';
        document.getElementById('statsOverview').style.display = 'none';
        document.getElementById('chartsSection').style.display = 'none';
        document.getElementById('recommendationsSection').style.display = 'none';
        document.getElementById('financialStatementsSection').style.display = 'block';
    }

    function displayFinancialStatement(data, type) {
        const financialContent = document.getElementById('financialContent');

        switch (type) {
            case 'profit_loss':
                financialContent.innerHTML = generateProfitLossStatement(data);
                break;
            case 'balance_sheet':
                financialContent.innerHTML = generateBalanceSheet(data);
                break;
            case 'cash_flow':
                financialContent.innerHTML = generateCashFlowStatement(data);
                break;
            case 'income_statement':
                financialContent.innerHTML = generateIncomeStatement(data);
                break;
            case 'financial_position':
                financialContent.innerHTML = generateFinancialPosition(data);
                break;
            case 'receivables':
                financialContent.innerHTML = generateReceivablesStatement(data);
                break;
            case 'payables':
                financialContent.innerHTML = generatePayablesStatement(data);
                break;
            default:
                financialContent.innerHTML = generateFinancialOverview(data);
        }
    }

    function generateProfitLossStatement(data) {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;

        return `
        <div class="financial-statement">
            <div class="statement-header">
                <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ ÙˆØ§Ù„Ø®Ø³Ø§Ø¦Ø±</div>
                <div class="statement-period">Ù…Ù† ${startDate} Ø¥Ù„Ù‰ ${endDate}</div>
            </div>

            <table class="financial-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                        <th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header">
                        <td colspan="2">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</td>
                    </tr>
                    <tr>
                        <td>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td>
                        <td class="amount-positive">125,450.00</td>
                    </tr>
                    <tr>
                        <td>Ø®ØµÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td>
                        <td class="amount-negative">(2,500.00)</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</strong></td>
                        <td><strong>122,950.00</strong></td>
                    </tr>

                    <tr class="category-header">
                        <td colspan="2">ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</td>
                    </tr>
                    <tr>
                        <td>ØªÙƒÙ„ÙØ© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</td>
                        <td class="amount-negative">(85,200.00)</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­</strong></td>
                        <td><strong class="amount-positive">37,750.00</strong></td>
                    </tr>

                    <tr class="category-header">
                        <td colspan="2">Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</td>
                    </tr>
                    <tr>
                        <td>Ù…ØµØ±ÙˆÙØ§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©</td>
                        <td class="amount-negative">(5,000.00)</td>
                    </tr>
                    <tr>
                        <td>Ù…ØµØ±ÙˆÙØ§Øª ØªØ³ÙˆÙŠÙ‚</td>
                        <td class="amount-negative">(3,000.00)</td>
                    </tr>
                    <tr>
                        <td>Ù…ØµØ±ÙˆÙØ§Øª Ø£Ø®Ø±Ù‰</td>
                        <td class="amount-negative">(1,500.00)</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</strong></td>
                        <td><strong>(9,500.00)</strong></td>
                    </tr>

                    <tr class="final-total">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</strong></td>
                        <td><strong>28,250.00</strong></td>
                    </tr>
                </tbody>
            </table>

            <div class="financial-summary">
                <div class="summary-card">
                    <div class="summary-value">23.0%</div>
                    <div class="summary-label">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">7.7%</div>
                    <div class="summary-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">23.0%</div>
                    <div class="summary-label">Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</div>
                </div>
            </div>
        </div>
        `;
    }

    function generateBalanceSheet(data) {
        const endDate = document.getElementById('endDate').value || new Date().toISOString().split('T')[0];

        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ©
        const cash = data.cash || 45000;
        const inventory = data.inventory_value || 85000;
        const receivables = data.accounts_receivable || 35000;
        const prepaidExpenses = data.prepaid_expenses || 8000;
        const equipment = data.equipment || 50000;
        const furniture = data.furniture || 15000;
        const accumulatedDepreciation = data.accumulated_depreciation || 12000;

        const payables = data.accounts_payable || 25000;
        const accruedExpenses = data.accrued_expenses || 18000;
        const shortTermLoans = data.short_term_loans || 15000;
        const longTermLoans = data.long_term_loans || 30000;
        const capital = data.capital || 150000;
        const retainedEarnings = data.retained_earnings || 27000;
        const currentYearProfit = data.current_year_profit || 28250;

        // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
        const totalCurrentAssets = cash + inventory + receivables + prepaidExpenses;
        const netFixedAssets = equipment + furniture - accumulatedDepreciation;
        const totalAssets = totalCurrentAssets + netFixedAssets;

        const totalCurrentLiabilities = payables + accruedExpenses + shortTermLoans;
        const totalLiabilities = totalCurrentLiabilities + longTermLoans;
        const totalEquity = capital + retainedEarnings + currentYearProfit;
        const totalLiabilitiesAndEquity = totalLiabilities + totalEquity;

        return `
        <div class="financial-statement">
            <div class="statement-header">
                <div class="statement-title">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©</div>
                <div class="statement-period">ÙƒÙ…Ø§ ÙÙŠ ${endDate}</div>
            </div>

            <!-- Ù…Ù„Ø®Øµ Ø³Ø±ÙŠØ¹ -->
            <div class="balance-summary mb-4">
                <div class="row">
                    <div class="col-md-3">
                        <div class="summary-card bg-primary text-white">
                            <div class="summary-value">${totalAssets.toLocaleString()}</div>
                            <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-card bg-danger text-white">
                            <div class="summary-value">${totalLiabilities.toLocaleString()}</div>
                            <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-card bg-success text-white">
                            <div class="summary-value">${totalEquity.toLocaleString()}</div>
                            <div class="summary-label">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="summary-card ${totalAssets === totalLiabilitiesAndEquity ? 'bg-success' : 'bg-warning'} text-white">
                            <div class="summary-value">${totalAssets === totalLiabilitiesAndEquity ? 'âœ“' : 'âœ—'}</div>
                            <div class="summary-label">ØªÙˆØ§Ø²Ù† Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <!-- Ø§Ù„Ø£ØµÙˆÙ„ -->
                <div class="col-md-6">
                    <table class="financial-table">
                        <thead>
                            <tr>
                                <th colspan="2" class="bg-primary text-white">
                                    <i class="fas fa-building"></i> Ø§Ù„Ø£ØµÙˆÙ„
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="category-header">
                                <td colspan="2"><i class="fas fa-coins"></i> Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ</td>
                                <td class="amount-positive">${cash.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-users"></i> Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© (Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡)</td>
                                <td class="amount-positive">${receivables.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-boxes"></i> Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</td>
                                <td class="amount-positive">${inventory.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-calendar-check"></i> Ù…ØµØ±ÙˆÙØ§Øª Ù…Ø¯ÙÙˆØ¹Ø© Ù…Ù‚Ø¯Ù…Ø§Ù‹</td>
                                <td class="amount-positive">${prepaidExpenses.toLocaleString()}</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</strong></td>
                                <td class="amount-positive"><strong>${totalCurrentAssets.toLocaleString()}</strong></td>
                            </tr>

                            <tr class="category-header">
                                <td colspan="2"><i class="fas fa-industry"></i> Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-cogs"></i> Ø§Ù„Ù…Ø¹Ø¯Ø§Øª ÙˆØ§Ù„Ø¢Ù„Ø§Øª</td>
                                <td class="amount-positive">${equipment.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-chair"></i> Ø§Ù„Ø£Ø«Ø§Ø« ÙˆØ§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª</td>
                                <td class="amount-positive">${furniture.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-minus-circle"></i> Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø¥Ù‡Ù„Ø§Ùƒ</td>
                                <td class="amount-negative">(${accumulatedDepreciation.toLocaleString()})</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>ØµØ§ÙÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©</strong></td>
                                <td class="amount-positive"><strong>${netFixedAssets.toLocaleString()}</strong></td>
                            </tr>

                            <tr class="final-total">
                                <td><strong><i class="fas fa-calculator"></i> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</strong></td>
                                <td class="amount-positive"><strong>${totalAssets.toLocaleString()}</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ© -->
                <div class="col-md-6">
                    <table class="financial-table">
                        <thead>
                            <tr>
                                <th colspan="2" class="bg-danger text-white">
                                    <i class="fas fa-credit-card"></i> Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="category-header">
                                <td colspan="2"><i class="fas fa-clock"></i> Ø§Ù„Ø®ØµÙˆÙ… Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-truck"></i> Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø© (Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†)</td>
                                <td class="amount-negative">${payables.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-file-invoice"></i> Ù…ØµØ±ÙˆÙØ§Øª Ù…Ø³ØªØ­Ù‚Ø©</td>
                                <td class="amount-negative">${accruedExpenses.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-hand-holding-usd"></i> Ù‚Ø±ÙˆØ¶ Ù‚ØµÙŠØ±Ø© Ø§Ù„Ø£Ø¬Ù„</td>
                                <td class="amount-negative">${shortTermLoans.toLocaleString()}</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ… Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</strong></td>
                                <td class="amount-negative"><strong>${totalCurrentLiabilities.toLocaleString()}</strong></td>
                            </tr>

                            <tr class="category-header">
                                <td colspan="2"><i class="fas fa-calendar-alt"></i> Ø§Ù„Ø®ØµÙˆÙ… Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ø£Ø¬Ù„</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-university"></i> Ù‚Ø±ÙˆØ¶ Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ø£Ø¬Ù„</td>
                                <td class="amount-negative">${longTermLoans.toLocaleString()}</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…</strong></td>
                                <td class="amount-negative"><strong>${totalLiabilities.toLocaleString()}</strong></td>
                            </tr>

                            <tr class="category-header">
                                <td colspan="2"><i class="fas fa-user-tie"></i> Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-piggy-bank"></i> Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</td>
                                <td class="amount-positive">${capital.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-chart-line"></i> Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø­ØªØ¬Ø²Ø©</td>
                                <td class="amount-positive">${retainedEarnings.toLocaleString()}</td>
                            </tr>
                            <tr>
                                <td><i class="fas fa-trophy"></i> Ø±Ø¨Ø­ Ø§Ù„Ø¹Ø§Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ</td>
                                <td class="amount-positive">${currentYearProfit.toLocaleString()}</td>
                            </tr>
                            <tr class="total-row">
                                <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong></td>
                                <td class="amount-positive"><strong>${totalEquity.toLocaleString()}</strong></td>
                            </tr>

                            <tr class="final-total">
                                <td><strong><i class="fas fa-balance-scale"></i> Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong></td>
                                <td class="amount-positive"><strong>${totalLiabilitiesAndEquity.toLocaleString()}</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ© -->
            <div class="financial-ratios mt-4">
                <h5><i class="fas fa-chart-pie"></i> Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h5>
                <div class="row">
                    <div class="col-md-3">
                        <div class="ratio-card">
                            <div class="ratio-value">${(totalCurrentAssets / totalCurrentLiabilities).toFixed(2)}</div>
                            <div class="ratio-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø¬Ø§Ø±ÙŠØ©</div>
                            <div class="ratio-status ${(totalCurrentAssets / totalCurrentLiabilities) > 2 ? 'text-success' : 'text-warning'}">
                                ${(totalCurrentAssets / totalCurrentLiabilities) > 2 ? 'Ù…Ù…ØªØ§Ø²' : 'Ù…Ù‚Ø¨ÙˆÙ„'}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ratio-card">
                            <div class="ratio-value">${((totalCurrentAssets - inventory) / totalCurrentLiabilities).toFixed(2)}</div>
                            <div class="ratio-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</div>
                            <div class="ratio-status ${((totalCurrentAssets - inventory) / totalCurrentLiabilities) > 1 ? 'text-success' : 'text-warning'}">
                                ${((totalCurrentAssets - inventory) / totalCurrentLiabilities) > 1 ? 'Ø¬ÙŠØ¯' : 'ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†'}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ratio-card">
                            <div class="ratio-value">${(totalLiabilities / totalAssets * 100).toFixed(1)}%</div>
                            <div class="ratio-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</div>
                            <div class="ratio-status ${(totalLiabilities / totalAssets) < 0.5 ? 'text-success' : 'text-warning'}">
                                ${(totalLiabilities / totalAssets) < 0.5 ? 'Ù…Ù†Ø®ÙØ¶Ø©' : 'Ù…ØªÙˆØ³Ø·Ø©'}
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="ratio-card">
                            <div class="ratio-value">${(totalEquity / totalAssets * 100).toFixed(1)}%</div>
                            <div class="ratio-label">Ù†Ø³Ø¨Ø© Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</div>
                            <div class="ratio-status ${(totalEquity / totalAssets) > 0.5 ? 'text-success' : 'text-warning'}">
                                ${(totalEquity / totalAssets) > 0.5 ? 'Ù‚ÙˆÙŠØ©' : 'Ù…ØªÙˆØ³Ø·Ø©'}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        `;
    }

    function generateCashFlowStatement(data) {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;

        return `
        <div class="financial-statement">
            <div class="statement-header">
                <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</div>
                <div class="statement-period">Ù…Ù† ${startDate} Ø¥Ù„Ù‰ ${endDate}</div>
            </div>

            <table class="financial-table">
                <thead>
                    <tr>
                        <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                        <th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="category-header">
                        <td colspan="2">Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</td>
                    </tr>
                    <tr>
                        <td>Ø§Ù„Ù…Ù‚Ø¨ÙˆØ¶Ø§Øª Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</td>
                        <td class="amount-positive">120,000.00</td>
                    </tr>
                    <tr>
                        <td>Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ù„Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</td>
                        <td class="amount-negative">(80,000.00)</td>
                    </tr>
                    <tr>
                        <td>Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª Ù„Ù„Ù…ØµØ±ÙˆÙØ§Øª</td>
                        <td class="amount-negative">(15,000.00)</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„ØªØ¯ÙÙ‚ Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</strong></td>
                        <td><strong class="amount-positive">25,000.00</strong></td>
                    </tr>

                    <tr class="category-header">
                        <td colspan="2">Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</td>
                    </tr>
                    <tr>
                        <td>Ø´Ø±Ø§Ø¡ Ù…Ø¹Ø¯Ø§Øª</td>
                        <td class="amount-negative">(10,000.00)</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„ØªØ¯ÙÙ‚ Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠØ©</strong></td>
                        <td><strong class="amount-negative">(10,000.00)</strong></td>
                    </tr>

                    <tr class="category-header">
                        <td colspan="2">Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</td>
                    </tr>
                    <tr>
                        <td>Ù‚Ø±ÙˆØ¶ Ø¬Ø¯ÙŠØ¯Ø©</td>
                        <td class="amount-positive">5,000.00</td>
                    </tr>
                    <tr class="total-row">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„ØªØ¯ÙÙ‚ Ù…Ù† Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</strong></td>
                        <td><strong class="amount-positive">5,000.00</strong></td>
                    </tr>

                    <tr class="final-total">
                        <td><strong>ØµØ§ÙÙŠ Ø§Ù„ØªØºÙŠØ± ÙÙŠ Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©</strong></td>
                        <td><strong class="amount-positive">20,000.00</strong></td>
                    </tr>
                    <tr>
                        <td>Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©</td>
                        <td>25,000.00</td>
                    </tr>
                    <tr class="final-total">
                        <td><strong>Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ÙØªØ±Ø©</strong></td>
                        <td><strong>45,000.00</strong></td>
                    </tr>
                </tbody>
            </table>
        </div>
        `;
    }

    function generateFinancialOverview(data) {
        return `
        <div class="financial-statement">
            <div class="statement-header">
                <div class="statement-title">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„ÙŠ</div>
            </div>

            <div class="financial-summary">
                <div class="summary-card">
                    <div class="summary-value">122,950</div>
                    <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">28,250</div>
                    <div class="summary-label">ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">220,000</div>
                    <div class="summary-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</div>
                </div>
                <div class="summary-card">
                    <div class="summary-value">177,000</div>
                    <div class="summary-label">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</div>
                </div>
            </div>

            <div style="margin-top: 2rem;">
                <h4>Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</h4>
                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ù…Ø¤Ø´Ø±</th>
                            <th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>
                            <th>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ù†Ø³Ø¨Ø© Ø§Ù„Ø³ÙŠÙˆÙ„Ø© Ø§Ù„Ø³Ø±ÙŠØ¹Ø©</td>
                            <td>3.6</td>
                            <td class="amount-positive">Ù…Ù…ØªØ§Ø²</td>
                        </tr>
                        <tr>
                            <td>Ù…Ø¹Ø¯Ù„ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</td>
                            <td>4.2</td>
                            <td class="amount-positive">Ø¬ÙŠØ¯</td>
                        </tr>
                        <tr>
                            <td>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„ØµØ§ÙÙŠ</td>
                            <td>23%</td>
                            <td class="amount-positive">Ù…Ù…ØªØ§Ø²</td>
                        </tr>
                        <tr>
                            <td>Ø§Ù„Ø¹Ø§Ø¦Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£ØµÙˆÙ„</td>
                            <td>12.8%</td>
                            <td class="amount-positive">Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        `;
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„
    function generateIncomeStatement(data) {
        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;

        return `
            <div class="financial-statement">
                <div class="statement-header">
                    <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</div>
                    <div class="statement-period">Ù„Ù„ÙØªØ±Ø© Ù…Ù† ${startDate} Ø¥Ù„Ù‰ ${endDate}</div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                            <th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="category-header">
                            <td colspan="2">Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</td>
                        </tr>
                        <tr>
                            <td>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td>
                            <td class="amount-positive">${(data.total_sales || 122950).toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø£Ø®Ø±Ù‰</td>
                            <td class="amount-positive">${(data.other_income || 2500).toLocaleString()}</td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</strong></td>
                            <td class="amount-positive"><strong>${((data.total_sales || 122950) + (data.other_income || 2500)).toLocaleString()}</strong></td>
                        </tr>

                        <tr class="category-header">
                            <td colspan="2">Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ ÙˆØ§Ù„Ù…ØµØ±ÙˆÙØ§Øª</td>
                        </tr>
                        <tr>
                            <td>ØªÙƒÙ„ÙØ© Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</td>
                            <td class="amount-negative">${(data.cost_of_goods || 75000).toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ù…ØµØ±ÙˆÙØ§Øª Ø§Ù„ØªØ´ØºÙŠÙ„</td>
                            <td class="amount-negative">${(data.operating_expenses || 15000).toLocaleString()}</td>
                        </tr>
                        <tr>
                            <td>Ù…ØµØ±ÙˆÙØ§Øª Ø¥Ø¯Ø§Ø±ÙŠØ©</td>
                            <td class="amount-negative">${(data.admin_expenses || 7200).toLocaleString()}</td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙƒØ§Ù„ÙŠÙ</strong></td>
                            <td class="amount-negative"><strong>${((data.cost_of_goods || 75000) + (data.operating_expenses || 15000) + (data.admin_expenses || 7200)).toLocaleString()}</strong></td>
                        </tr>

                        <tr class="final-total">
                            <td><strong>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</strong></td>
                            <td class="amount-positive"><strong>${(((data.total_sales || 122950) + (data.other_income || 2500)) - ((data.cost_of_goods || 75000) + (data.operating_expenses || 15000) + (data.admin_expenses || 7200))).toLocaleString()}</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        `;
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ
    function generateFinancialPosition(data) {
        const reportDate = document.getElementById('endDate').value || new Date().toISOString().split('T')[0];

        return `
            <div class="financial-statement">
                <div class="statement-header">
                    <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ù…Ø§Ù„ÙŠ</div>
                    <div class="statement-period">ÙƒÙ…Ø§ ÙÙŠ ${reportDate}</div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <h4>Ø§Ù„Ø£ØµÙˆÙ„</h4>
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                                    <th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="category-header">
                                    <td colspan="2">Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ù†Ù‚Ø¯ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ</td>
                                    <td class="amount-positive">${(data.cash || 45000).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</td>
                                    <td class="amount-positive">${(data.accounts_receivable || 35000).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</td>
                                    <td class="amount-positive">${(data.inventory_value || 85000).toLocaleString()}</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</strong></td>
                                    <td class="amount-positive"><strong>${((data.cash || 45000) + (data.accounts_receivable || 35000) + (data.inventory_value || 85000)).toLocaleString()}</strong></td>
                                </tr>

                                <tr class="category-header">
                                    <td colspan="2">Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ù…Ø¹Ø¯Ø§Øª ÙˆØ§Ù„Ø£Ø¬Ù‡Ø²Ø©</td>
                                    <td class="amount-positive">${(data.equipment || 35000).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ø£Ø«Ø§Ø« ÙˆØ§Ù„ØªØ¬Ù‡ÙŠØ²Ø§Øª</td>
                                    <td class="amount-positive">${(data.furniture || 20000).toLocaleString()}</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„ Ø§Ù„Ø«Ø§Ø¨ØªØ©</strong></td>
                                    <td class="amount-positive"><strong>${((data.equipment || 35000) + (data.furniture || 20000)).toLocaleString()}</strong></td>
                                </tr>

                                <tr class="final-total">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£ØµÙˆÙ„</strong></td>
                                    <td class="amount-positive"><strong>${((data.cash || 45000) + (data.accounts_receivable || 35000) + (data.inventory_value || 85000) + (data.equipment || 35000) + (data.furniture || 20000)).toLocaleString()}</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="col-md-6">
                        <h4>Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</h4>
                        <table class="financial-table">
                            <thead>
                                <tr>
                                    <th>Ø§Ù„Ø¨ÙŠØ§Ù†</th>
                                    <th>Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="category-header">
                                    <td colspan="2">Ø§Ù„Ø®ØµÙˆÙ… Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©</td>
                                    <td class="amount-negative">${(data.accounts_payable || 25000).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td>Ù…ØµØ±ÙˆÙØ§Øª Ù…Ø³ØªØ­Ù‚Ø©</td>
                                    <td class="amount-negative">${(data.accrued_expenses || 18000).toLocaleString()}</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ… Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„Ø©</strong></td>
                                    <td class="amount-negative"><strong>${((data.accounts_payable || 25000) + (data.accrued_expenses || 18000)).toLocaleString()}</strong></td>
                                </tr>

                                <tr class="category-header">
                                    <td colspan="2">Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</td>
                                </tr>
                                <tr>
                                    <td>Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</td>
                                    <td class="amount-positive">${(data.capital || 150000).toLocaleString()}</td>
                                </tr>
                                <tr>
                                    <td>Ø§Ù„Ø£Ø±Ø¨Ø§Ø­ Ø§Ù„Ù…Ø­ØªØ¬Ø²Ø©</td>
                                    <td class="amount-positive">${(data.retained_earnings || 27000).toLocaleString()}</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong></td>
                                    <td class="amount-positive"><strong>${((data.capital || 150000) + (data.retained_earnings || 27000)).toLocaleString()}</strong></td>
                                </tr>

                                <tr class="final-total">
                                    <td><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ… ÙˆØ­Ù‚ÙˆÙ‚ Ø§Ù„Ù…Ù„ÙƒÙŠØ©</strong></td>
                                    <td class="amount-positive"><strong>${((data.accounts_payable || 25000) + (data.accrued_expenses || 18000) + (data.capital || 150000) + (data.retained_earnings || 27000)).toLocaleString()}</strong></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        `;
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©
    function generateReceivablesStatement(data) {
        return `
            <div class="financial-statement">
                <div class="statement-header">
                    <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</div>
                    <div class="statement-period">Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ø¯ÙŠÙ†ÙŠÙ†</div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                            <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ù…Ø¹Ø§Ù…Ù„Ø©</th>
                            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø¹Ù„ÙŠ</td>
                            <td>01234567890</td>
                            <td class="amount-positive">1,500</td>
                            <td>2025-07-15</td>
                            <td>18 ÙŠÙˆÙ…</td>
                            <td><span class="text-success">Ø¹Ø§Ø¯ÙŠ</span></td>
                        </tr>
                        <tr>
                            <td>ÙØ§Ø·Ù…Ø© Ø­Ø³Ù†</td>
                            <td>01098765432</td>
                            <td class="amount-positive">750</td>
                            <td>2025-07-20</td>
                            <td>13 ÙŠÙˆÙ…</td>
                            <td><span class="text-warning">ØªØ­Ø°ÙŠØ±</span></td>
                        </tr>
                        <tr>
                            <td>Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯</td>
                            <td>01555666777</td>
                            <td class="amount-positive">2,200</td>
                            <td>2025-06-25</td>
                            <td>38 ÙŠÙˆÙ…</td>
                            <td><span class="text-danger">Ù…ØªØ£Ø®Ø±</span></td>
                        </tr>
                        <tr>
                            <td>Ø¹Ù„ÙŠ Ø­Ø³ÙŠÙ†</td>
                            <td>01777888999</td>
                            <td class="amount-positive">950</td>
                            <td>2025-07-28</td>
                            <td>5 Ø£ÙŠØ§Ù…</td>
                            <td><span class="text-success">Ø¹Ø§Ø¯ÙŠ</span></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="final-total">
                            <td colspan="2"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</strong></td>
                            <td class="amount-positive"><strong>5,400</strong></td>
                            <td colspan="3"></td>
                        </tr>
                    </tfoot>
                </table>

                <div class="mt-3">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-success">2</div>
                                <div class="summary-label">Ø­Ø³Ø§Ø¨Ø§Øª Ø¹Ø§Ø¯ÙŠØ©</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-warning">1</div>
                                <div class="summary-label">Ø­Ø³Ø§Ø¨Ø§Øª ØªØ­Ø°ÙŠØ±</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-danger">1</div>
                                <div class="summary-label">Ø­Ø³Ø§Ø¨Ø§Øª Ù…ØªØ£Ø®Ø±Ø©</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©
    function generatePayablesStatement(data) {
        return `
            <div class="financial-statement">
                <div class="statement-header">
                    <div class="statement-title">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©</div>
                    <div class="statement-period">Ø§Ù„Ù…Ø³ØªØ­Ù‚Ø§Øª Ù„Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†</div>
                </div>

                <table class="financial-table">
                    <thead>
                        <tr>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ±Ø¯</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                            <th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø¢Ø®Ø± Ù…Ø¹Ø§Ù…Ù„Ø©</th>
                            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…</th>
                            <th>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙˆØ± Ù„Ù„ØªØ¬Ø§Ø±Ø©</td>
                            <td>01111222333</td>
                            <td class="amount-negative">5,000</td>
                            <td>2025-07-10</td>
                            <td>23 ÙŠÙˆÙ…</td>
                            <td><span class="text-warning">Ù…ØªÙˆØ³Ø·Ø©</span></td>
                        </tr>
                        <tr>
                            <td>Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ù…Ù„ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©</td>
                            <td>01444555666</td>
                            <td class="amount-negative">3,200</td>
                            <td>2025-07-18</td>
                            <td>15 ÙŠÙˆÙ…</td>
                            <td><span class="text-info">Ù…Ù†Ø®ÙØ¶Ø©</span></td>
                        </tr>
                        <tr>
                            <td>Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</td>
                            <td>01888999000</td>
                            <td class="amount-negative">12,500</td>
                            <td>2025-07-05</td>
                            <td>28 ÙŠÙˆÙ…</td>
                            <td><span class="text-danger">Ø¹Ø§Ù„ÙŠØ©</span></td>
                        </tr>
                        <tr>
                            <td>Ù…Ø¤Ø³Ø³Ø© Ø§Ù„ØªÙ‚Ø¯Ù…</td>
                            <td>01333444555</td>
                            <td class="amount-negative">2,800</td>
                            <td>2025-07-25</td>
                            <td>8 Ø£ÙŠØ§Ù…</td>
                            <td><span class="text-info">Ù…Ù†Ø®ÙØ¶Ø©</span></td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="final-total">
                            <td colspan="2"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©</strong></td>
                            <td class="amount-negative"><strong>23,500</strong></td>
                            <td colspan="3"></td>
                        </tr>
                    </tfoot>
                </table>

                <div class="mt-3">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-danger">1</div>
                                <div class="summary-label">Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-warning">1</div>
                                <div class="summary-label">Ø£ÙˆÙ„ÙˆÙŠØ© Ù…ØªÙˆØ³Ø·Ø©</div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="summary-card">
                                <div class="summary-value text-info">2</div>
                                <div class="summary-label">Ø£ÙˆÙ„ÙˆÙŠØ© Ù…Ù†Ø®ÙØ¶Ø©</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    // ØªÙ‚Ø±ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª
    async function generatePaymentHistoryReport() {
        try {
            const response = await fetch('/api/payments/history');
            const data = await response.json();

            let html = `
                <div class="analytics-report">
                    <h4>Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø§Øª</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ø¹Ù…ÙŠÙ„/Ø§Ù„Ù…ÙˆØ±Ø¯</th>
                                <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
                                <th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
                                <th>Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            // Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ©
            const samplePayments = [
                { date: '2025-08-01', type: 'ØªØ­ØµÙŠÙ„', customer: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯', amount: 500, method: 'Ù†Ù‚Ø¯ÙŠ', notes: 'Ø¯ÙØ¹Ø© Ø¬Ø²Ø¦ÙŠØ©' },
                { date: '2025-07-30', type: 'Ø¯ÙØ¹', supplier: 'Ø´Ø±ÙƒØ© Ø§Ù„Ù†ÙˆØ±', amount: 2000, method: 'ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ', notes: 'Ø¯ÙØ¹ ÙØ§ØªÙˆØ±Ø©' },
                { date: '2025-07-28', type: 'ØªØ­ØµÙŠÙ„', customer: 'ÙØ§Ø·Ù…Ø© Ø­Ø³Ù†', amount: 750, method: 'Ù†Ù‚Ø¯ÙŠ', notes: 'ØªØ³ÙˆÙŠØ© ÙƒØ§Ù…Ù„Ø©' }
            ];

            samplePayments.forEach(payment => {
                const typeClass = payment.type === 'ØªØ­ØµÙŠÙ„' ? 'text-success' : 'text-primary';
                html += `
                    <tr>
                        <td>${payment.date}</td>
                        <td><span class="${typeClass}">${payment.type}</span></td>
                        <td>${payment.customer || payment.supplier}</td>
                        <td>${payment.amount.toLocaleString()} Ø¬.Ù…</td>
                        <td>${payment.method}</td>
                        <td>${payment.notes}</td>
                    </tr>
                `;
            });

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('reportContent').innerHTML = html;
            showAllSections();

        } catch (error) {
            console.error('Error generating payment history report:', error);
        }
    }

    // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
    async function generateOutOfStockReport() {
        try {
            const response = await fetch('/api/products');
            const result = await response.json();
            const products = result.success ? result.data : [];

            const outOfStock = products.filter(product => product.quantity <= 5);

            let html = `
                <div class="analytics-report">
                    <h4>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ù…Ù†Ø®ÙØ¶)</h4>
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        ÙŠÙˆØ¬Ø¯ ${outOfStock.length} Ù…Ù†ØªØ¬ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙˆÙŠÙ†
                    </div>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
                                <th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</th>
                                <th>Ø³Ø¹Ø± Ø§Ù„Ø¨ÙŠØ¹</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            if (outOfStock.length > 0) {
                outOfStock.forEach(product => {
                    const status = product.quantity === 0 ? 'Ù†ÙØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†' : 'Ù…Ø®Ø²ÙˆÙ† Ù…Ù†Ø®ÙØ¶';
                    const statusClass = product.quantity === 0 ? 'text-danger' : 'text-warning';
                    const action = product.quantity === 0 ? 'Ø·Ù„Ø¨ ÙÙˆØ±ÙŠ' : 'Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙˆÙŠÙ†';

                    html += `
                        <tr>
                            <td>${product.name}</td>
                            <td><span class="${statusClass}">${product.quantity}</span></td>
                            <td>${product.price.toLocaleString()} Ø¬.Ù…</td>
                            <td><span class="${statusClass}">${status}</span></td>
                            <td><span class="badge bg-warning">${action}</span></td>
                        </tr>
                    `;
                });
            } else {
                html += '<tr><td colspan="5" class="text-center text-success">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…ØªÙˆÙØ±Ø© Ø¨ÙƒÙ…ÙŠØ§Øª ÙƒØ§ÙÙŠØ©</td></tr>';
            }

            html += `
                        </tbody>
                    </table>
                </div>
            `;

            document.getElementById('reportContent').innerHTML = html;
            showAllSections();

        } catch (error) {
            console.error('Error generating out of stock report:', error);
        }
    }

    function exportFinancialStatement() {
        alert('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© Ø§Ù„ØªØµØ¯ÙŠØ± Ù‚Ø±ÙŠØ¨Ø§Ù‹');
    }

    function printFinancialStatement() {
        const content = document.getElementById('financialContent').innerHTML;
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <html>
            <head>
                <title>Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø§Ù„ÙŠØ©</title>
                <style>
                    body { font-family: Arial, sans-serif; direction: rtl; }
                    .financial-table { width: 100%; border-collapse: collapse; }
                    .financial-table th, .financial-table td {
                        border: 1px solid #ddd; padding: 8px; text-align: right;
                    }
                    .financial-table th { background: #f5f5f5; }
                    .category-header { background: #007bff; color: white; }
                    .total-row { background: #f0f8ff; font-weight: bold; }
                    .final-total { background: #007bff; color: white; font-weight: bold; }
                    .amount-positive { color: green; }
                    .amount-negative { color: red; }
                </style>
            </head>
            <body>${content}</body>
            </html>
        `);
        printWindow.document.close();
        printWindow.print();
    }

    // Advanced Analytics Functions
    async function fetchAdvancedAnalytics(reportType) {
        let apiUrl = '';

        // ØªØ­Ø¯ÙŠØ¯ API Ø§Ù„Ù…Ù†Ø§Ø³Ø¨ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ±
        if (['best-products', 'time-analysis', 'inventory-predictions', 'slow-moving', 'automated-report'].includes(reportType)) {
            apiUrl = `/api/analytics/${reportType}`;
        } else if (reportType.startsWith('sales-summary-')) {
            const period = reportType.split('-')[2]; // daily, monthly, yearly
            apiUrl = `/api/advanced/sales-summary?period=${period}`;
        } else if (reportType === 'best-products-sales') {
            apiUrl = `/api/advanced/best-products?by=sales`;
        } else if (reportType === 'best-products-profit') {
            apiUrl = `/api/advanced/best-products?by=profit`;
        } else if (reportType === 'best-customers') {
            apiUrl = `/api/advanced/best-customers`;
        } else if (reportType === 'payment-delays') {
            apiUrl = `/api/advanced/payment-delays`;
        } else if (reportType === 'inventory-status') {
            apiUrl = `/api/advanced/inventory-status`;
        } else if (reportType === 'profit-analysis') {
            apiUrl = `/api/advanced/profit-analysis`;
        } else if (reportType === 'business-plan') {
            apiUrl = `/api/advanced/business-plan`;
        } else if (reportType === 'sales-prediction') {
            apiUrl = `/api/advanced/sales-prediction`;
        } else if (reportType === 'customer-behavior') {
            apiUrl = `/api/advanced/customer-behavior`;
        } else if (reportType === 'smart-alerts') {
            apiUrl = `/api/advanced/smart-alerts`;
        } else {
            apiUrl = `/api/analytics/${reportType}`;
        }

        const response = await fetch(apiUrl);
        const result = await response.json();
        return result.data;
    }

    function displayAdvancedAnalytics(data, reportType) {
        const analyticsContent = document.getElementById('analyticsContent');

        switch (reportType) {
            case 'best-products':
                analyticsContent.innerHTML = generateBestProductsReport(data);
                break;
            case 'time-analysis':
                analyticsContent.innerHTML = generateTimeAnalysisReport(data);
                break;
            case 'inventory-predictions':
                analyticsContent.innerHTML = generateInventoryPredictionsReport(data);
                break;
            case 'slow-moving':
                analyticsContent.innerHTML = generateSlowMovingReport(data);
                break;
            case 'automated-report':
                analyticsContent.innerHTML = generateAutomatedReport(data);
                break;
            case 'sales-summary-daily':
            case 'sales-summary-monthly':
            case 'sales-summary-yearly':
                analyticsContent.innerHTML = generateSalesSummaryReport(data, reportType);
                break;
            case 'best-products-sales':
            case 'best-products-profit':
                analyticsContent.innerHTML = generateAdvancedBestProductsReport(data, reportType);
                break;
            case 'best-customers':
                analyticsContent.innerHTML = generateBestCustomersReport(data);
                break;
            case 'payment-delays':
                analyticsContent.innerHTML = generatePaymentDelaysReport(data);
                break;
            case 'inventory-status':
                analyticsContent.innerHTML = generateInventoryStatusReport(data);
                break;
            case 'profit-analysis':
                analyticsContent.innerHTML = generateProfitAnalysisReport(data);
                break;
            case 'business-plan':
                analyticsContent.innerHTML = generateBusinessPlanReport(data);
                break;
            case 'sales-prediction':
                analyticsContent.innerHTML = generateSalesPredictionReport(data);
                break;
            case 'customer-behavior':
                analyticsContent.innerHTML = generateCustomerBehaviorReport(data);
                break;
            case 'smart-alerts':
                analyticsContent.innerHTML = generateSmartAlertsReport(data);
                break;
        }
    }

    function generateBestProductsReport(data) {
        let html = '<div class="analytics-report">';
        html += '<h4>Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Ù‹</h4>';

        if (data.top_by_quantity && data.top_by_quantity.length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th></tr></thead><tbody>';

            data.top_by_quantity.forEach(item => {
                html += `<tr>
                    <td>${item.product_name}</td>
                    <td>${item.quantity}</td>
                    <td>${item.total.toFixed(2)} Ø¬.Ù…</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateTimeAnalysisReport(data) {
        let html = '<div class="analytics-report">';
        html += '<h4>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª ÙˆØ§Ù„Ø£ÙŠØ§Ù…</h4>';

        if (data.best_days) {
            html += '<h5>Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙŠØ§Ù…</h5>';
            html += '<div class="row">';
            data.best_days.forEach(day => {
                html += `<div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h6>${day.day_name}</h6>
                            <p>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${day.total.toFixed(2)} Ø¬.Ù…</p>
                        </div>
                    </div>
                </div>`;
            });
            html += '</div>';
        }

        if (data.peak_hours) {
            html += '<h5>Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ©</h5>';
            html += '<div class="row">';
            data.peak_hours.forEach(hour => {
                html += `<div class="col-md-4">
                    <div class="card">
                        <div class="card-body">
                            <h6>Ø§Ù„Ø³Ø§Ø¹Ø© ${hour.hour}:00</h6>
                            <p>Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${hour.total.toFixed(2)} Ø¬.Ù…</p>
                        </div>
                    </div>
                </div>`;
            });
            html += '</div>';
        }

        html += '</div>';
        return html;
    }

    function generateInventoryPredictionsReport(data) {
        let html = '<div class="analytics-report">';
        html += '<h4>ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h4>';

        if (Object.keys(data).length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</th><th>Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©</th><th>Ø§Ù„ØªÙˆØµÙŠØ©</th></tr></thead><tbody>';

            Object.values(data).forEach(item => {
                html += `<tr>
                    <td>${item.product_name}</td>
                    <td>${item.current_stock}</td>
                    <td>${item.predicted_total_sales}</td>
                    <td>${item.recommended_order > 0 ? 'Ø§Ø·Ù„Ø¨ ' + item.recommended_order + ' Ù‚Ø·Ø¹Ø©' : 'Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙƒØ§ÙÙŠ'}</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateSlowMovingReport(data) {
        let html = '<div class="analytics-report">';
        html += '<h4>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø±Ø§ÙƒØ¯Ø©</h4>';

        if (data.length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</th><th>Ø¢Ø®Ø± Ø¨ÙŠØ¹</th><th>Ø§Ù„ØªÙˆØµÙŠØ©</th></tr></thead><tbody>';

            data.forEach(item => {
                html += `<tr>
                    <td>${item.product_name}</td>
                    <td>${item.current_stock}</td>
                    <td>${item.days_since_last_sale} ÙŠÙˆÙ…</td>
                    <td>${item.recommendation}</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateAutomatedReport(data) {
        let html = '<div class="analytics-report">';
        html += '<h4>Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</h4>';

        // Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡
        if (data.summary) {
            html += '<div class="summary-section">';
            html += '<h5>Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ø¯Ø§Ø¡</h5>';
            html += `<p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª: ${data.summary.total_revenue?.toFixed(2) || 0} Ø¬.Ù…</p>`;
            html += `<p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª: ${data.summary.total_transactions || 0}</p>`;
            html += `<p>Ù…ØªÙˆØ³Ø· Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©: ${data.summary.avg_transaction_value?.toFixed(2) || 0} Ø¬.Ù…</p>`;
            html += '</div>';
        }

        // Ø§Ù„ØªÙˆØµÙŠØ§Øª
        if (data.recommendations && data.recommendations.length > 0) {
            html += '<div class="recommendations-section">';
            html += '<h5>Ø§Ù„ØªÙˆØµÙŠØ§Øª</h5>';
            data.recommendations.forEach(rec => {
                html += `<div class="alert alert-info">
                    <strong>${rec.title}</strong><br>
                    ${rec.description}<br>
                    <em>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: ${rec.action}</em>
                </div>`;
            });
            html += '</div>';
        }

        html += '</div>';
        return html;
    }

    function showAdvancedAnalyticsSections() {
        document.getElementById('aiInsights').style.display = 'none';
        document.getElementById('statsOverview').style.display = 'none';
        document.getElementById('chartsSection').style.display = 'none';
        document.getElementById('recommendationsSection').style.display = 'none';
        document.getElementById('financialStatementsSection').style.display = 'none';
        document.getElementById('advancedAnalyticsSection').style.display = 'block';
    }

    // Export Functions
    function exportToPDF() {
        const reportType = document.getElementById('reportType').value;
        if (!reportType) {
            alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ø§Ù‹');
            return;
        }

        window.open(`/api/export/pdf?type=${reportType}`, '_blank');
    }

    function exportToExcel() {
        const reportType = document.getElementById('reportType').value;
        if (!reportType) {
            alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ø§Ù‹');
            return;
        }

        window.open(`/api/export/excel?type=${reportType}`, '_blank');
    }

    // Ø¯ÙˆØ§Ù„ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    function generateSalesSummaryReport(data, reportType) {
        const periodName = reportType.includes('daily') ? 'Ø§Ù„ÙŠÙˆÙ…ÙŠØ©' :
                          reportType.includes('monthly') ? 'Ø§Ù„Ø´Ù‡Ø±ÙŠØ©' : 'Ø§Ù„Ø³Ù†ÙˆÙŠØ©';

        let html = `<div class="analytics-report">
            <h4>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ${periodName}</h4>
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5>${data.total_sales?.toFixed(2) || 0} Ø¬.Ù…</h5>
                            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5>${data.average_per_period?.toFixed(2) || 0} Ø¬.Ù…</h5>
                            <p>Ù…ØªÙˆØ³Ø· Ø§Ù„ÙØªØ±Ø©</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <h5>${data.trend || 'Ù…Ø³ØªÙ‚Ø±'}</h5>
                            <p>Ø§Ù„Ø§ØªØ¬Ø§Ù‡</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>`;

        return html;
    }

    function generateAdvancedBestProductsReport(data, reportType) {
        const isProfit = reportType.includes('profit');
        const title = isProfit ? 'Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø±Ø¨Ø­ÙŠØ©' : 'Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¨ÙŠØ¹Ø§Ù‹';

        let html = `<div class="analytics-report">
            <h4>${title}</h4>`;

        if (data.top_products && Object.keys(data.top_products).length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th>';

            if (isProfit) {
                html += '<th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø¨Ø­</th><th>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­</th><th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</th>';
            } else {
                html += '<th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</th>';
            }

            html += '</tr></thead><tbody>';

            Object.entries(data.top_products).forEach(([key, item]) => {
                const productName = key.split(',')[1] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                html += `<tr><td>${productName}</td>`;

                if (isProfit) {
                    html += `<td>${item.profit?.toFixed(2) || 0} Ø¬.Ù…</td>
                            <td>${item.profit_margin?.toFixed(1) || 0}%</td>
                            <td>${item.quantity_sold || 0}</td>`;
                } else {
                    html += `<td>${item.quantity_sold || 0}</td>
                            <td>${item.revenue?.toFixed(2) || 0} Ø¬.Ù…</td>`;
                }

                html += '</tr>';
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateBestCustomersReport(data) {
        let html = '<div class="analytics-report"><h4>Ø£ÙØ¶Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h4>';

        if (data.top_customers && Object.keys(data.top_customers).length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</th><th>Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©</th></tr></thead><tbody>';

            Object.entries(data.top_customers).forEach(([key, customer]) => {
                const customerName = key.split(',')[1] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
                html += `<tr>
                    <td>${customerName}</td>
                    <td>${customer.amount?.toFixed(2) || 0} Ø¬.Ù…</td>
                    <td>${customer.transaction_count || 0}</td>
                    <td>${customer.avg_transaction?.toFixed(2) || 0} Ø¬.Ù…</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generatePaymentDelaysReport(data) {
        let html = '<div class="analytics-report"><h4>ØªÙ‚Ø§Ø±ÙŠØ± ØªØ£Ø®Ø± Ø§Ù„Ø³Ø¯Ø§Ø¯</h4>';

        html += `<div class="row mb-4">
            <div class="col-md-4">
                <div class="card text-center bg-danger text-white">
                    <div class="card-body">
                        <h5>${data.customers_with_debt || 0}</h5>
                        <p>Ø¹Ù…Ù„Ø§Ø¡ Ù…ØªØ£Ø®Ø±ÙŠÙ†</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card text-center bg-warning text-white">
                    <div class="card-body">
                        <h5>${data.total_debt?.toFixed(2) || 0} Ø¬.Ù…</h5>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ†ÙŠØ©</p>
                    </div>
                </div>
            </div>
        </div>`;

        if (data.delay_details && data.delay_details.length > 0) {
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø³ØªØ­Ù‚</th><th>Ø£ÙŠØ§Ù… Ø§Ù„ØªØ£Ø®ÙŠØ±</th><th>Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø®Ø§Ø·Ø±</th></tr></thead><tbody>';

            data.delay_details.forEach(customer => {
                const riskClass = customer.risk_level === 'Ø¹Ø§Ù„ÙŠ' ? 'text-danger' :
                                 customer.risk_level === 'Ù…ØªÙˆØ³Ø·' ? 'text-warning' : 'text-success';

                html += `<tr>
                    <td>${customer.customer_name}</td>
                    <td>${customer.debt_amount?.toFixed(2) || 0} Ø¬.Ù…</td>
                    <td>${customer.days_overdue || 0} ÙŠÙˆÙ…</td>
                    <td class="${riskClass}">${customer.risk_level}</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateInventoryStatusReport(data) {
        let html = '<div class="analytics-report"><h4>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø­Ø§Ù„ÙŠ</h4>';

        html += `<div class="row mb-4">
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h5>${data.total_products || 0}</h5>
                        <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center bg-success text-white">
                    <div class="card-body">
                        <h5>${data.total_inventory_value?.toFixed(2) || 0} Ø¬.Ù…</h5>
                        <p>Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center bg-warning text-white">
                    <div class="card-body">
                        <h5>${data.low_stock_products?.length || 0}</h5>
                        <p>Ù…Ù†ØªØ¬Ø§Øª ØªÙ†ÙØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center bg-danger text-white">
                    <div class="card-body">
                        <h5>${data.out_of_stock_products?.length || 0}</h5>
                        <p>Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©</p>
                    </div>
                </div>
            </div>
        </div>`;

        // Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†ÙØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹
        if (data.low_stock_products && data.low_stock_products.length > 0) {
            html += '<h5>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ØªÙŠ ØªÙ†ÙØ¯ Ù‚Ø±ÙŠØ¨Ø§Ù‹</h5>';
            html += '<div class="table-responsive"><table class="table table-striped">';
            html += '<thead><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</th><th>Ø­Ø¯ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡</th><th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</th></tr></thead><tbody>';

            data.low_stock_products.forEach(product => {
                html += `<tr>
                    <td>${product.product_name}</td>
                    <td>${product.current_quantity}</td>
                    <td>${product.alert_quantity}</td>
                    <td>${product.stock_value?.toFixed(2) || 0} Ø¬.Ù…</td>
                </tr>`;
            });

            html += '</tbody></table></div>';
        }

        html += '</div>';
        return html;
    }

    function generateSmartAlertsReport(data) {
        let html = '<div class="analytics-report"><h4>Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</h4>';

        if (data && data.length > 0) {
            data.forEach(alert => {
                const alertClass = alert.priority === 'Ø¹Ø§Ù„ÙŠØ©' ? 'alert-danger' :
                                  alert.priority === 'Ù…ØªÙˆØ³Ø·Ø©' ? 'alert-warning' : 'alert-info';

                html += `<div class="alert ${alertClass}">
                    <h6><i class="fas fa-exclamation-triangle"></i> ${alert.title}</h6>
                    <p>${alert.message}</p>
                    <small><strong>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨:</strong> ${alert.action}</small>
                </div>`;
            });
        } else {
            html += '<div class="alert alert-success">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ</div>';
        }

        html += '</div>';
        return html;
    }
</script>
{% endblock %}
